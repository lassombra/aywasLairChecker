{"href":"javascript:(function(){var%20process%20=%20function%20()%20%7B%0D%0A%20%20%20%20var%20page%20=%201,%20petsTable%20=%20%5B%5D,%20resultsTable%20=%20%7B%7D,%20userID,%20version%20=%200.7,%20phoneHome%20=%20false,%20remoteVersion,%0D%0A%20%20%20%20%20%20%20%20versionCheckComplete%20=%20false,%20versionAnswer;%0D%0A%0D%0A%20%20%20%20function%20versionCheck()%20%7B%0D%0A%20%20%20%20%20%20%20%20versionCheckComplete%20=%20true;%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20function%20generateOutput()%20%7B%0D%0A%20%20%20%20%20%20%20%20if%20(!versionCheckComplete)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20window.setTimeout(generateOutput,%20100);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20if%20(phoneHome)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20$.get(%22http://aywaslairchecker.net/checkin.php%22,%20%7Bid:%20userID,%20version:%20version,%20lite:%20true%7D);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20var%20count%20=%200;%0D%0A%20%20%20%20%20%20%20%20for%20(c%20in%20resultsTable)%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20count%20+=%20resultsTable%5Bc%5D.length;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20var%20output%20=%20document.createElement('div'),%20k,%20ul,%20li,%20a,%20i;%0D%0A%20%20%20%20%20%20%20%20ul%20=%20document.createElement('p');%0D%0A%20%20%20%20%20%20%20%20$(ul).text(%22Total%20pets:%20%22+count);%0D%0A%20%20%20%20%20%20%20%20$(ul).addClass('keep');%0D%0A%20%20%20%20%20%20%20%20$(output).append(ul);%0D%0A%20%20%20%20%20%20%20%20for%20(k%20in%20resultsTable)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(resultsTable.hasOwnProperty(k))%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(resultsTable%5Bk%5D.length%20%3E%200)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%20=%200;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ul%20=%20document.createElement('ul');%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$(ul).text(k);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(i%20=%200;%20i%20%3C%20resultsTable%5Bk%5D.length;%20i%20+=%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20li%20=%20document.createElement('li');%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20a%20=%20document.createElement('a');%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$(a).text(resultsTable%5Bk%5D%5Bi%5D.name);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$(a).attr(%22href%22,%20%22http://www.aywas.com/pp/view/%22%20+%20resultsTable%5Bk%5D%5Bi%5D.id%20+%20%22/%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$(li).append(a);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$(ul).append(li);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$(output).append(ul);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20$('title').text(%22Aywas%20Lair%20Checker%20-%20Results%22);%0D%0A%20%20%20%20%20%20%20%20if%20(versionAnswer)%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20$('body').append(versionAnswer);%0D%0A%20%20%20%20%20%20%20%20$('body').append($(output));%0D%0A%20%20%20%20%20%20%20%20$('p:not(%22.keep%22)').hide().queue(function%20(next)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20$(this).remove();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20next();%0D%0A%20%20%20%20%20%20%20%20%7D);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20function%20addTable(element)%20%7B%0D%0A%20%20%20%20%20%20%20%20var%20breed,%20id,%20name;%0D%0A%20%20%20%20%20%20%20%20breed%20=%20$(element).find(%22.gen-small%20%3E%20a%20%3E%20strong%22).text().split('%20the%20');%0D%0A%20%20%20%20%20%20%20%20breed%20=%20breed%5Bbreed.length%20-%201%5D;%0D%0A%20%20%20%20%20%20%20%20breed%20=%20breed.trim().split('(')%5B0%5D.trim().replace(/%5E%5Cs*%5CS*(Male%7CFemale%7CAndrogynous%7CHermaphrodite%7CUndecided%7CRobot)/i,%20%22%22).trim();%0D%0A%20%20%20%20%20%20%20%20id%20=%20Number($(element).find(%22.gen-small%20%3E%20a%20%3E%20strong%22).text().split('(')%5B1%5D.match(/%5Cd+/ig)%5B0%5D);%0D%0A%20%20%20%20%20%20%20%20name%20=%20$(element).find(%22.gen-small%20%3E%20a%20%3E%20strong%22).text();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!resultsTable%5Bbreed%5D)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resultsTable%5Bbreed%5D%20=%20%5B%5D;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20resultsTable%5Bbreed%5D.push(%7Bid:%20id,%20name:%20name%7D);%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20function%20addTables()%20%7B%0D%0A%20%20%20%20%20%20%20%20var%20i;%0D%0A%20%20%20%20%20%20%20%20for%20(i%20=%200;%20i%20%3C%20petsTable.length;%20i%20+=%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20addTable(petsTable%5Bi%5D);%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20generateOutput();%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20%0D%0A%20%20%20%20var%20pagesRunning%20=%200;%0D%0A%20%20%20%20function%20fetchPage()%20%7B%0D%0A%20%20%20%20%20%20%20%20$('body').append($(%22%3Cp%3ELoading%20page%20%22%20+%20page%20+%20%22.%20%20Pets%20loaded%20so%20far:%20%22%20+%20petsTable.length%20+%20%22%3C/p%3E%22));%0D%0A%20%20%20%20%20%20%20%20$('title').text(%22Aywas%20Lair%20Checker:%20Loading%20page%20%22%20+%20page%20+%20%22.%20%20Pets%20loaded%20so%20far:%20%22%20+%20petsTable.length);%0D%0A%20%20%20%20%20%20%20%20var%20listUrl%20=%20%22http://www.aywas.com/lair/group/%22%20+%20userID%20+%20%22/all/?p=%22%20+%20page%20+%20%22&l=240%22,%20pageResult%20=%20%5B%5D,%20i;%0D%0A%20%20%20%20%20%20%20%20$.ajax(listUrl,%20%7BdataType:%20%22text%22,%20success:%20function%20(xml)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20pagesRunning%20+=%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20page%20=%20page%20+%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(pageResult.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fetchPage();%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20xml%20=%20xml.replace(/%3C%5B%5E%5C/%5D*img%5B%5E%3E%5D*%3E(%5B%5E%3C%5D*%3C%5B%5E%5C/%5Cw%5D*%5C/img%5B%5E%3E%5D*%3E)*/gi,%20%22%22);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20pageResult%20=%20$(xml).find('div#lair-sort-pets%20%3E%20div');%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(i%20=%200;%20i%20%3C%20pageResult.length;%20i%20+=%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20petsTable.push(pageResult%5Bi%5D);%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20pagesRunning%20-=%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20page%20=%20page%20+%201;%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!pageResult.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//End%20load%20watches%20for%20pages%20running%20to%20be%200%20and%20then%20%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20endLoad();%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%7D%7D);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20function%20endLoad()%7B%0D%0A%20%20%20%20%20%20%20%20if%20(pagesRunning%20%3E%200)%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20window.setTimeout(endLoad,100);%0D%0A%20%20%20%20%20%20%20%20%7Delse%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20$('body').append($(%22%3Cp%3ELoad%20complete.%20%20Loaded%20%22%20+%20petsTable.length%20+%20%22%20pets.%3C/p%3E%22));%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20addTables();%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20function%20getUserID()%20%7B%0D%0A%20%20%20%20%20%20%20%20userID%20=%20$(%22div#side%20%3E%20h3%20%3E%20a%22);%0D%0A%20%20%20%20%20%20%20%20if%20(userID%20&&%20userID.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20userID%20=%20Number(userID.attr('href').match(/%5Cd+/i)%5B0%5D);%0D%0A//%20%20%20%20%20%20%20%20%20%20%20%20userID=1165;%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%0D%0A%20%20%20%20var%20scripts%20=%20document.getElementsByTagName('script');%0D%0A%20%20%20%20while%20(scripts.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20scripts%5B0%5D.parentElement.removeChild(scripts%5B0%5D);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20scripts%20=%20document.getElementsByTagName('link');%0D%0A%20%20%20%20while%20(scripts.length)%20%7B%0D%0A%20%20%20%20%20%20%20%20scripts%5B0%5D.parentElement.removeChild(scripts%5B0%5D);%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20var%20script%20=%20document.createElement('script');%0D%0A%20%20%20%20script.src%20=%20%22//code.jquery.com/jquery-1.10.2.min.js%22;%0D%0A%20%20%20%20script.type%20=%20%22text/javascript%22;%0D%0A%20%20%20%20script.onload%20=%20function%20()%20%7B%0D%0A%20%20%20%20%20%20%20%20getUserID();%0D%0A%20%20%20%20%20%20%20%20$('body').remove();%0D%0A%20%20%20%20%20%20%20%20$('html').append($('%3Cbody%3E%3C/body%3E'));%0D%0A%20%20%20%20%20%20%20%20$('body').append($('%3Ch1%3EAywas%20Lair%20Lister%3C/h1%3E'));%0D%0A%20%20%20%20%20%20%20%20window.setTimeout(versionCheck,%201);%0D%0A%20%20%20%20%20%20%20%20fetchPage();%0D%0A%20%20%20%20%7D;%0D%0A%20%20%20%20document.getElementsByTagName('head')%5B0%5D.appendChild(script);%0D%0A//%20%20%20%20window.setTimeout(function()%7B%0D%0A//%20%20%20%20%20%20%20%20getUserID();%0D%0A//%20%20%20%20%20%20%20%20$('body').remove();%0D%0A//%20%20%20%20%20%20%20%20$('html').append($('%3Cbody%3E%3C/body%3E'));%0D%0A//%20%20%20%20%20%20%20%20$('body').append($('%3Ch1%3EAywas%20Lair%20Checker%20V'+version+'%3C/h1%3E'));%0D%0A//%20%20%20%20%20%20%20%20fetchPage();%0D%0A//%20%20%20%20%7D,%20500);%0D%0A%7D;%0D%0Aif%20(!(location.host.match(/.*aywas.*/ig)%20&&%20location.host.match(/.*aywas.*/ig).length)%20&&%20!(location.hostname.match(/.*aywas.*/ig)%20&&%20location.hostname.match(/.*aywas.*/ig).length))%20%7B%0D%0A%20%20%20%20alert(%22Please%20re-run%20this%20bookmarklet%20from%20Aywas.com!%22);%0D%0A%20%20%20%20location.href%20=%20%22http://www.aywas.com/%22;%0D%0A%7D%0D%0Aelse%7B%0D%0A%20%20%20%20process();%0D%0A%7D%0D%0A})();"}